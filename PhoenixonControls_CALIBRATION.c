/*
 * PhoenixonControls_CALIBRATION.c
 *
 *  Created on: 2018. 5. 20.
 *      Author: BGKim
 */
#include "../../../common/include/F28x_Project.h"
#include "../../../common/include/driverlib.h"
#include "../../../common/include/device.h"
#pragma CODE_SECTION(CALIBRATION_ConversionREF, ".TI.ramfunc");
#pragma CODE_SECTION(CALIBRATION_ConversionADC, ".TI.ramfunc");
#pragma CODE_SECTION(CALIBRATION_ConversionCurrentADC, ".TI.ramfunc");
#pragma CODE_SECTION(CALIBRATION_ConversionVoltageADC, ".TI.ramfunc");

#ifdef _DEBUG_PRINTF_CALL
#include <stdio.h>
#endif

#ifdef _DEBUG

float32 DEBUG_CAL_CHARGE_CURRENT_REF_VALUE   = 0.0;
float32 DEBUG_CAL_DISCHARGE_CURRENT_REF_VALUE= 0.0;


#endif//  END _DEBUGE


//
//**********************CHANNEL_01_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 1
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.998666666666667, 1.99866666666667, 2.99866666666667, 3.99866666666667, 4.99866666666667 };

float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = {0.0, };
float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999786377    ,
1.999557492 ,
2.99923706  ,
3.99911499  ,
4.998794554 };

float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.99991298 ,
1.99954498  ,
2.99912715  ,
3.99878955  ,
4.99836922  };


//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{-0.048248, 9.95753360660091, 19.9672763028043, 29.9800195213987, 39.9897622176021, 50.0025054361964, 60.0122481323998, 70.0219908286033, 80.0377345695886, 90.047477265792
 , 100.060220484386, 110.071163389546, 120.08090608575, 130.090648781953, 140.103392000547, 150.113134696751, 160.128878437736, 170.138621133939, 180.148363830143, 190.161107048737
 , 200.173850267332, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.064359, 10.0649523081969, 20.0776955267912, 30.0844377006037, 40.0911798744161, 50.1039230930105, 60.1136657892139, 70.1204079630264, 80.1361517040117, 90.1428938778241
 , 100.155637096419, 110.161179061275, 120.173922279869, 130.180664453681, 140.193407672276, 150.203150368479, 160.218894109464, 170.231637328059, 180.238379501871, 190.254123242857
 , 200.26386593906, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0590085909, 10.0207319, 20.0119591, 30.0165977, 40.0024605, 50.0070992, 60.0063744, 70.0110168, 80.0102844, 89.9961548
 , 100.008835, 109.994698, 120.007385, 130.001282, 140.000565, 150.002518, 160.007172, 169.979614, 179.99498, 189.999619
 , 200.006943, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{-0.00268220808, 9.9751339, 19.9744072, 29.9710007, 39.9568634, 49.9668655, 59.9580917, 69.962738, 79.9673691, 89.9693298
 , 99.9659195, 109.962509, 119.961784, 129.950333, 139.963013, 149.962296, 159.958878, 169.947418, 179.944031, 189.945984
 , 199.955978, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif

//
//**********************CHANNEL_01_END************************
//




//
//**********************CHANNEL_02_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 2
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.999, 1.999, 2.999, 3.999, 4.999 };


float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 1.001, 2.001, 3.001, 4.001, 5.001 };

float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.00047302 ,
2.000549316 ,
3.000579838 ,
4.000579834 ,
5.000549318 };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999615987    ,
1.999320983 ,
2.999178570 ,
3.999214173 ,
4.999037740 };


//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0, 9.98753883051039, 19.98527943715, 29.9830200437896, 39.9807606504292, 49.9815017794598, 59.9792423860994, 69.976982992739, 79.9807246441605, 89.9754647284092
 , 99.9792063798307, 109.975146673036, 119.975887802066, 129.979629453488, 139.974369537737, 149.969109621985, 159.972851273407, 169.970591880046, 179.968332486686, 189.969073615716
 , 199.966814222356, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.020272, 10.0259455171145, 20.0236861237541, 30.0214267303938, 40.0191673370334, 50.0199084660639, 60.0116480279217, 70.0093886345613, 80.0131302859828, 90.0048698478405
 , 100.005610976871, 109.999150852163, 119.993890936412, 129.988631020661, 139.989372149691, 149.98411223394, 159.984853362971, 169.98259396961, 179.974333531468, 189.975074660498
 , 199.969814744747, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.00804662425, 9.99927425, 19.9878197, 29.987093, 39.9810028, 49.9829597, 59.9849167, 69.9734573, 79.9834595, 89.9720078
 , 99.9739685, 109.970558, 119.969833, 129.966431, 139.963013, 149.954239, 159.961563, 169.960846, 179.960114, 189.959381
 , 199.955978, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.0187754594, 10.0126858, 20.0039139, 30.0005035, 40.0051422, 50.0017357, 59.9983292, 69.9922333, 79.9888306, 89.9961472
 , 99.9793243, 109.967873, 119.969833, 129.979828, 139.968384, 149.964966, 159.964249, 169.966202, 179.949371, 189.959381
 , 199.953293, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_02_END************************
//




//
//**********************CHANNEL_03_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 3
/////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = {0.0, };
float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.999333333333333, 1.99933333333333, 2.99933333333333, 3.99933333333333, 4.99933333333333 };

float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999412537    ,
1.999346413 ,
2.999178570 ,
3.999214170 ,
4.998867030 };


float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.002571107    ,
1.999880470 ,
2.999649050 ,
3.999493917 ,
4.999471190 };



//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.015513, 9.99053935290134, 20.0002820491048, 30.0130252676991, 40.0227679639025, 50.0385117048878, 60.0482544010912, 70.0579970972946, 80.0767413606709, 90.0864840568743
 , 100.10222779786, 110.113170703019, 120.128914444005, 130.138657140208, 140.151400358802, 150.164143577397, 160.182887840773, 170.192630536976, 180.205373755571, 190.218116974165
 , 200.23086019276, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.0418, 10.055950741024, 20.0656934372274, 30.0784366558218, 40.0881793520252, 50.1009225706196, 60.110665266823, 70.1174074406354, 80.1361517040117, 90.1428938778241
 , 100.155637096419, 110.167180106056, 120.17692280226, 130.186665498463, 140.199408717058, 150.212151935652, 160.224895154246, 170.23463785045, 180.244380546653, 190.257123765248
 , 200.269866983842, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0321865045, 10.0100031, 20.003912, 30.0112343, 39.9944153, 50.0178299, 60.0144196, 70.0244293, 80.0371094, 90.041748
 , 100.043709, 110.042976, 120.044937, 130.041519, 140.051514, 150.061523, 160.060806, 170.070816, 180.045944, 190.072037
 , 200.065948, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.00804662611, 10.0153675, 20.0200062, 30.0246449, 40.0212364, 50.0285568, 60.0224686, 70.0297852, 80.0317459, 90.033699
 , 100.038338, 110.037613, 120.044937, 130.049561, 140.048843, 150.045441, 160.060806, 170.049347, 180.062042, 190.053253
 , 200.057892, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_03_END************************
//




//
//**********************CHANNEL_04_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 4
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.998333333333334, 1.99833333333333, 2.99833333333333, 3.99833333333333, 4.99833333333333 };

float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.998333333333334, 1.99833333333333, 2.99833333333333, 3.99833333333333, 4.99833333333333 };

float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999908447    ,
1.999786374 ,
2.99963379  ,
3.999420166 ,
4.999465942 };


float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.000239053    ,
2.005180357 ,
2.999738057 ,
3.999455770 ,
4.999086380 };


//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0, 9.98753883051039, 19.988279959541, 29.9920216109625, 39.995763262384, 49.9965043914145, 60.0002460428361, 70.0009871718666, 80.01072986807, 90.0114709971006
 , 100.015212648522, 110.017153986509, 120.020895637931, 130.021636766961, 140.025378418383, 150.029120069804, 160.038862766008, 170.039603895038, 180.040345024069, 190.04408667549
 , 200.047828326912, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.03124, 10.0349470842874, 20.0356882133179, 30.0394298647394, 40.04017099377, 50.0439126451915, 60.0416532518311, 70.0453949032527, 80.0491365546742, 90.0498776837047
 , 100.053619335126, 110.0531602552, 120.053901384231, 130.054642513262, 140.055383642292, 150.059125293714, 160.065867467526, 170.066608596557, 180.067349725587, 190.071091377009
 , 200.071832506039, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0295042973, 10.0126858, 20.0200062, 30.0165977, 40.0239182, 50.0151482, 60.0144196, 70.0271072, 80.0236969, 90.0202866
 , 100.03566, 110.0242, 120.031525, 130.028107, 140.062256, 150.032028, 160.042038, 170.03595, 180.013763, 190.045227
 , 200.033752, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.00268220995, 10.0019569, 20.003912, 29.9978218, 40.0078278, 49.999054, 60.0036926, 69.9949188, 80.004921, 90.0068741
 , 100.01152, 110.008102, 120.007385, 130.009338, 140.016663, 150.002533, 160.007156, 170.017181, 180.013763, 190.018387
 , 200.01767, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_04_END************************
//




//
//**********************CHANNEL_05_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 5
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = {0.0, };
float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 1.00066666666667, 2.00066666666667, 3.00066666666667, 4.00066666666667, 5.00066666666667 };

float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.000183104    ,
2.000442508 ,
3.000549318 ,
4.000717162 ,
5.00090027  };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.000582377    ,
2.000656130 ,
3.000857033 ,
4.000943503 ,
4.999990460 };



//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{-0.033524, 9.93052890508237, 19.9342705565039, 29.9410127303163, 39.9477549041288, 49.9574976003322, 59.9642397741447, 69.9679814255662, 79.9837251665515, 89.9904673403639
 , 100.000210036567, 110.008152419336, 120.011894070758, 130.021636766961, 140.028378940774, 150.038121636977, 160.050864855571, 170.057607029384, 180.064349203196, 190.0740918994
 , 200.080834073212, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.061, 10.0769543977606, 20.0806960491822, 30.0874382229946, 40.0911798744161, 50.1009225706196, 60.1016636996501, 70.1084058734626, 80.1211490920569, 90.1218902210875
 , 100.131632917291, 110.137174882147, 120.140916533568, 130.14465818499, 140.151400358802, 150.158142532615, 160.1738862736, 170.177627925022, 180.181369576443, 190.191112272647
 , 200.197854446459, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0697374269, 9.9912281, 19.9958668, 29.9978218, 40.0024605, 50.0097809, 60.0090561, 70.0083313, 80.0076065, 90.0149231
 , 100.016876, 110.016159, 120.002014, 130.012024, 140.024719, 150.021301, 160.02594, 170.019836, 180.008392, 190.034485
 , 200.031082, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{-0.00804662704, 9.983181, 19.9851379, 29.9924583, 39.9836884, 49.9829559, 59.9875946, 69.9761429, 79.986145, 89.9854202
 , 99.9846954, 109.983963, 119.988602, 129.993256, 139.987152, 149.983749, 160.007156, 169.995697, 179.99231, 189.999619
 , 199.988159, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_05_END************************
//




//
//**********************CHANNEL_06_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 6
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = {0.0, };
float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = { 1.00133333333333, 2.00133333333333, 3.00133333333333, 4.00133333333333, 5.00133333333333 };

float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.000239057    ,
1.999916080 ,
2.999699910 ,
3.999481200 ,
4.999083040 };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999323527    ,
1.999015810 ,
2.998822530 ,
3.998616533 ,
4.998295310 };



//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{-0.029981, 9.96053412899186, 19.9732773475862, 29.9890210885715, 40.0017643071659, 50.0205085705421, 60.0332517891365, 70.0459950077309, 80.0647392711071, 90.0804830120924
 , 100.096226753078, 110.107169658237, 120.122913399223, 130.135656617817, 140.148399836412, 150.161143055006, 160.179887318382, 170.192630536976, 180.205373755571, 190.221117496556
 , 200.233860715151, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.06506, 10.0709533529788, 20.0836965715731, 30.0964397901675, 40.1061824863709, 50.1219262273562, 60.1316689235596, 70.141411619763, 80.1601558831393, 90.1698985793427
 , 100.182641797937, 110.191184285184, 120.203927503778, 130.213670199982, 140.229413940967, 150.23615611478, 160.254900378156, 170.26764359675, 180.277386292954, 190.293130033939
 , 200.305873252533, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0402331278, 9.99659157, 19.9931831, 30.0031853, 39.9944115, 49.9963684, 59.9929619, 69.9922333, 79.9995575, 89.9988327
 , 99.979332, 109.994698, 120.002022, 129.995926, 139.979111, 149.983734, 159.991058, 169.995697, 179.984253, 189.986206
 , 199.982788, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0, 9.98586273, 19.9878197, 29.9870949, 39.9810028, 49.9856415, 59.9795494, 69.973465, 79.970047, 89.9720154
 , 99.9739685, 109.975922, 119.972511, 129.966431, 139.968384, 149.962296, 159.964249, 169.955475, 179.962799, 189.954025
 , 199.96402, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_06END************************
//




//
//**********************CHANNEL_07_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 7
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = { 0.999, 1.999, 2.999, 3.999, 4.999 };

float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999,
1.999,
2.999,
3.994,
5,
};
float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999704996    ,
1.999397277 ,
2.999331160 ,
3.999074303 ,
4.998956200 };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.000264487    ,
2.000249227 ,
2.994771323 ,
4.004914603 ,
4.999658580 };



//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{-0.010508, 9.93953047225522, 19.9342705565039, 29.9350116855345, 39.9327522921741, 49.9334934212046, 59.9342345502352, 69.9319751568748, 79.9417178530782, 89.9364579373269
 , 99.9401995887484, 109.939140404344, 119.939881533375, 129.937622140015, 139.941363791436, 149.909099174166, 159.945846571888, 169.943587178528, 179.944328307558, 189.945069436589
 , 199.945810565619, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.06903, 10.0649523081969, 20.0626929148365, 30.063434043867, 40.0581741281157, 50.0589152571463, 60.0566558637859, 70.0543964704255, 80.061138644238, 90.0558787284866
 , 100.059620379908, 110.056160777591, 120.056901906622, 130.054642513262, 140.055383642292, 150.053124248932, 160.059866422744, 170.054606506993, 180.052347113632, 190.050087720272
 , 200.044827804521, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0697374269, 10.0073204, 20.0119591, 30.0058708, 40.0051422, 50.0151443, 60.0036926, 69.9922333, 80.004921, 89.9934692
 , 99.9981079, 109.99202, 119.985924, 130.009338, 140.016647, 149.978394, 159.988388, 169.95816, 179.984253, 189.994247
 , 199.972076, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{-0.00536441803, 9.983181, 19.9797726, 29.9763641, 39.9729576, 49.9722328, 59.9741859, 69.9600525, 79.9700546, 89.9532318
 , 99.960556, 109.951782, 119.956421, 129.944962, 139.944244, 149.943512, 159.937424, 169.936691, 179.935974, 189.924515
 , 199.926468, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_07_END************************
//




//
//**********************CHANNEL_08_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 8
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = {0.0, };
float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = {0.0, };
float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999730428    ,
1.999460853 ,
2.999051413 ,
3.998692827 ,
4.998435500 };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999692281    ,
1.999435423 ,
2.999127707 ,
3.998908997 ,
4.998559950 };



//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0, 9.99954092007418, 20.0062830938866, 30.0160257900901, 40.0257684862935, 50.0355111824969, 60.0452538787003, 70.0519960525127, 80.067739793498, 90.0774824897015
 , 100.087225185905, 110.095167568674, 120.104910264877, 130.114652961081, 140.124395657284, 150.131137831096, 160.149882094473, 170.156624268285, 180.166366964489, 190.176109660692
 , 200.185852356895, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.01399, 10.0229449947236, 20.032687690927, 30.0394298647394, 40.0461720385519, 50.0559147347553, 60.0626569085678, 70.0663985599893, 80.0821423009746, 90.0858839523961
 , 100.0956266486, 110.101168613456, 120.107910787268, 130.114652961081, 140.124395657284, 150.128137308705, 160.143881049691, 170.150623223503, 180.157365397316, 190.167108093519
 , 200.173850267332, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0187754612, 10.0073204, 20.003912, 30.0031853, 39.9997787, 50.0017357, 60.0036926, 69.9922333, 79.9968719, 89.9934692
 , 100.003471, 110.000061, 119.993973, 129.99057, 139.973755, 149.991806, 159.991058, 169.990341, 179.984253, 189.986206
 , 199.977432, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{-0.0107288342, 9.983181, 19.9797726, 29.9844112, 39.9783211, 49.980278, 59.9661407, 69.9600525, 79.9646912, 89.9639587
 , 99.9659195, 109.959824, 119.959106, 129.953003, 139.94693, 149.946198, 159.950836, 169.944733, 179.949387, 189.943298
 , 199.937195, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_08_END************************
//




//
//**********************CHANNEL_09_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 9
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = { 0.999, 1.999, 2.999, 3.999, 4.999 };

float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = {0.0, };
float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999946594    ,
1.999994913 ,
2.999865217 ,
4.000091550 ,
4.999753950 };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999844869    ,
1.999778747 ,
2.999712627 ,
3.999773660 ,
4.999776840 };




//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.050021, 10.0385477111565, 20.0152846610595, 30.0100247453082, 39.9987637847749, 49.9935038690236, 59.9852434308813, 69.9739824703481, 79.9717230769877, 89.9634626388454
 , 99.9552022007031, 109.948141971517, 119.939881533375, 129.928620572842, 139.92336065709, 149.915100218948, 159.912840825588, 169.904580387445, 179.899320471694, 189.894060555943
 , 199.891801162582, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.0, 9.9929397708141, 19.9876798550628, 29.9854204617024, 39.980160545951, 49.9749006301997, 59.9696407144484, 69.9613802763061, 79.9621214053367, 89.9568614895854
 , 99.954602096225, 109.945141449126, 119.939881533375, 129.931621095233, 139.929361701872, 149.924101786121, 159.921842392761, 169.913581954618, 179.908322038867, 189.906062645507
 , 199.900802729755, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0268220864, 10.020731, 20.0146408, 30.0165977, 40.0131912, 50.0124664, 60.0144196, 70.0083313, 79.9995575, 90.0095596
 , 100.006149, 109.994698, 120.010071, 130.001282, 140.024719, 149.991791, 160.001801, 169.998383, 179.989624, 189.996933
 , 200.006943, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.0214576703, 9.99659157, 19.9931831, 29.9924583, 39.9890518, 49.9856415, 59.9822311, 69.973465, 79.9754181, 89.9746857
 , 99.9659119, 109.957146, 119.972511, 129.966431, 139.971069, 149.959595, 159.969604, 169.955475, 179.949387, 189.951355
 , 199.945251, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//
//**********************CHANNEL_09_END************************
//




//
//**********************CHANNEL_10_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 10
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.999, 1.999, 2.999, 3.999, 4.999 };

float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.000,
2.000,
2.994,
3.999,
5.000};


float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.000251773    ,
2.000249223 ,
3.000208537 ,
4.000256860 ,
4.999995710 };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999755859    ,
1.999842327 ,
3.005035397 ,
3.999977110 ,
4.999905110 };



//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.03396, 10.0055419648561, 20.0092836162776, 30.0160257900901, 40.0197674415116, 50.029510137715, 60.0332517891365, 70.036993440558, 80.0497366591524, 90.0534783105739
 , 100.060220484386, 110.068162867155, 120.071904518577, 130.075646169998, 140.085388866202, 150.089130517623, 160.098873213827, 170.102614865248, 180.10935703906, 190.116099212873
 , 200.119840864295, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.015, 10.0169439499417, 20.0206856013632, 30.0274277751757, 40.0311694265972, 50.0379116004096, 60.0416532518311, 70.0423943808617, 80.0551375994561, 90.0558787284866
 , 100.062620902299, 110.065162344764, 120.068903996186, 130.072645647607, 140.07938782142, 150.083129472841, 160.092872169045, 170.096613820466, 180.097354949497, 190.104097123309
 , 200.110839297122, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0268220864, 9.99390984, 20.0012302, 30.0005035, 39.9997787, 49.9856415, 59.9929619, 69.9895554, 79.9915085, 90.0122452
 , 99.9954224, 109.983963, 119.996658, 129.969101, 139.992523, 149.989105, 159.988388, 170.027893, 179.986938, 189.999619
 , 199.985474, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.0482797548, 10.0046387, 20.0012321, 29.9978218, 39.9917297, 50.0017357, 59.9875984, 69.9895477, 79.9968719, 89.9961548
 , 99.987381, 109.986649, 119.991287, 129.979828, 139.981796, 149.975708, 159.985703, 169.974243, 179.976196, 189.978149
 , 199.96402, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_10_END************************
//




//
//**********************CHANNEL_11_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 11
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.999, 1.999, 2.999, 3.999, 4.999 };

float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = {0.0, };
float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.00010943 ,
2.00020981  ,
3.00026464  ,
4.00038576  ,
5.00038719  };




float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.000429790    ,
2.000516257 ,
3.000221253 ,
4.000269570 ,
4.999934670 };



//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0, 9.9695356961647, 19.9552742132405, 29.9410127303163, 39.9267512473922, 49.9184908092499, 59.9042293263257, 69.8899678434015, 79.8847079276502, 89.870446444726
 , 99.8591854841928, 109.846124210225, 119.831862727301, 129.817601244377, 139.809340806234, 149.79507932331, 159.786818885168, 169.772557402244, 179.75829591932, 189.747034958786
 , 199.735773998253, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.04247, 10.0259455171145, 20.0056829894085, 29.9884209840933, 39.9711589787782, 49.9538969734631, 59.933634445757, 69.9133719180509, 79.9021109575177, 89.8848489522026
 , 99.8705874692784, 109.849124732616, 119.831862727301, 129.814600721986, 139.800339239062, 149.783077233746, 159.774816795604, 169.754554267898, 179.740292784974, 189.72603130205
 , 199.711769819125, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0348687135, 10.0073204, 20.0065956, 30.013916, 40.0024605, 50.0044174, 59.9849167, 70.0002823, 80.004921, 90.0122452
 , 100.008835, 109.992012, 119.964462, 130.003967, 140.011292, 149.954239, 159.999115, 170.009109, 179.952057, 190.010345
 , 199.950623, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.0375509225, 10.0207319, 20.0146408, 30.013916, 40.0105057, 50.0124626, 60.0171013, 70.0056458, 80.0156555, 90.0068817
 , 100.006157, 110.00811, 119.993973, 130.006653, 139.995209, 149.991791, 159.999115, 169.998383, 179.99765, 189.991577
 , 199.988159, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_11_END************************
//




//
//**********************CHANNEL_12_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 12
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 1.001, 2.001, 3.001, 4.001, 5.001 };

float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.999, 1.999, 2.999, 3.999, 4.999 };

float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999772549    ,
1.99961424  ,
2.99931884  ,
3.99918246  ,
4.99885893  };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.000404357    ,
2.000096640 ,
2.999712627 ,
3.999252320 ,
4.998953340 };



//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{-0.026614, 9.95453308420996, 19.9552742132405, 29.9560153422711, 39.9567564713017, 49.9574976003322, 59.9582387293628, 69.9559793360024, 79.9657220322058, 89.9634626388454
 , 99.9672042902669, 109.966145105863, 119.966886234893, 129.967627363924, 139.968368492955, 149.969109621985, 159.975851795798, 169.976592924828, 179.977334053859, 189.978075182889
 , 199.981816834311, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.05315, 10.058951263415, 20.0566918700546, 30.0574329990851, 40.0581741281157, 50.0589152571463, 60.0566558637859, 70.0543964704255, 80.061138644238, 90.0588792508776
 , 100.059620379908, 110.056160777591, 120.056901906622, 130.057643035653, 140.058384164683, 150.056124771323, 160.062866945135, 170.060607551775, 180.061348680805, 190.062089809836
 , 200.062830938866, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0455975495, 9.99659157, 19.9878197, 29.987093, 39.9917297, 49.9856415, 59.9715042, 69.973465, 79.9807816, 89.9827423
 , 99.9739685, 109.975922, 119.969833, 129.974472, 139.965698, 149.951569, 159.964249, 169.950104, 179.946701, 189.932556
 , 199.934509, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.00268220901, 10.0073204, 20.0039139, 29.9978218, 39.9944153, 49.9829636, 59.9849167, 69.9680939, 79.9727325, 89.9800568
 , 99.968605, 109.96788, 119.953735, 129.958374, 139.946915, 149.935455, 159.94278, 169.936707, 179.933289, 189.937927
 , 199.926483, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_12_END************************
//




//
//**********************CHANNEL_13_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 13
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 1.00133333333333, 2.00133333333333, 3.00133333333333, 4.00133333333333, 5.00133333333333 };

float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.998666666666667, 1.99866666666667, 2.99866666666667, 3.99866666666667, 4.99866666666667 };

float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999526977    ,
1.999231973 ,
2.998847963 ,
3.998730977 ,
4.998024460 };


float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999641418    ,
1.999193827 ,
2.998847963 ,
3.998718260 ,
4.998133180 };



//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{-0.032742, 9.93052890508237, 19.9342705565039, 29.9350116855345, 39.938753336956, 49.9454955107684, 59.946236639799, 69.9499782912205, 79.9597209874239, 89.9604621164545
 , 99.9672042902669, 109.969145628254, 119.972887279675, 129.973628408706, 139.980370582518, 149.981111711549, 159.990854407752, 169.991595536783, 179.995337188204, 189.999078839626
 , 200.002820491048, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.08698, 10.0949575321063, 20.0986991835279, 30.1024408349494, 40.1031819639799, 50.1069236154014, 60.107664744432, 70.1084058734626, 80.118148569666, 90.1188896986965
 , 100.122631350118, 110.122172270192, 120.125913921614, 130.126655050644, 140.130396702066, 150.134138353487, 160.143881049691, 170.14162165633, 180.145363307752, 190.149104959173
 , 200.149846088204, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.077784054, 10.0126858, 20.0065956, 30.0085526, 39.9944153, 50.0017357, 59.9902802, 69.9841919, 79.9941864, 89.9934692
 , 99.9900589, 109.986649, 119.991287, 129.977142, 139.979111, 149.964981, 159.993744, 169.9823, 179.973526, 189.967438
 , 199.950607, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.00268220878, 10.0046387, 19.9958668, 29.987093, 39.9836845, 49.9829597, 59.9715042, 69.973465, 79.9754181, 89.9639587
 , 99.960556, 109.951782, 119.967155, 129.953018, 139.949615, 149.946198, 159.953522, 169.942062, 179.941345, 189.935242
 , 199.923798, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_13_END************************
//




//
//**********************CHANNEL_14_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 14
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.999, 1.999, 2.999, 3.999, 4.999 };

float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = {0.0, };
float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999984740    ,
1.999537150 ,
2.999242143 ,
3.998718263 ,
4.998299120 };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999425253    ,
1.999015807 ,
2.998720803 ,
3.998362227 ,
4.997940540 };


//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{-0.037108, 9.96053412899186, 19.9732773475862, 29.9830200437896, 39.995763262384, 50.0085064809783, 60.0212496995727, 70.033992918167, 80.0527371815433, 90.0624798777467
 , 100.078223618732, 110.092167046283, 120.104910264877, 130.117653483471, 140.133397224457, 150.14313992066, 160.164884706427, 170.177627925022, 180.190371143616, 190.20311436221
 , 200.218858103196, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.06961, 10.0709533529788, 20.0836965715731, 30.0964397901675, 40.1061824863709, 50.1189257049652, 60.1316689235596, 70.141411619763, 80.1601558831393, 90.1698985793427
 , 100.185642320328, 110.197185329966, 120.20992854856, 130.219671244764, 140.235414985749, 150.248158204343, 160.26690246772, 170.279645686314, 180.292388904908, 190.308132645894
 , 200.320875864488, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0509619638, 9.99390984, 19.9851379, 29.9870949, 39.9836884, 49.9749146, 59.9661407, 69.9654083, 79.9727325, 89.9666443
 , 99.9498291, 109.96788, 119.953735, 129.950333, 139.960327, 149.943512, 159.950836, 169.947433, 179.935974, 189.937927
 , 199.931839, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.00804662611, 9.98586273, 19.9824562, 29.9763641, 39.9729576, 49.972229, 59.9661407, 69.962738, 79.9593201, 89.9612808
 , 99.960556, 109.943741, 119.948372, 129.926193, 139.933502, 149.930115, 159.918655, 169.917923, 179.927917, 189.919159
 , 199.9077, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_14_END************************
//




//
//**********************CHANNEL_15_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 15
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.999333333333333, 1.99933333333333, 2.99933333333333, 3.99933333333333, 4.99933333333333 };

float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 0.999333333333333, 1.99933333333333, 2.99933333333333, 3.99933333333333, 4.99933333333333 };

float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999374390    ,
1.999079390 ,
2.998504640 ,
3.998031613 ,
4.997641090 };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999832153    ,
1.999270123 ,
2.998962403 ,
3.998845417 ,
4.998212810 };




//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{-0.074533, 9.94553151703712, 19.9552742132405, 29.9650169094439, 39.9717590832564, 49.9845023018508, 59.9912444756632, 69.9979866494757, 80.013730390461, 90.0204725642734
 , 100.033215782868, 110.041158165637, 120.047900339449, 130.057643035653, 140.067385731856, 150.074127905668, 160.089871646654, 170.096613820466, 180.103355994279, 190.113098690482
 , 200.119840864295, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.087755, 10.0889564873244, 20.0986991835279, 30.1084418797313, 40.1151840535437, 50.1249267497471, 60.1346694459505, 70.1384110973721, 80.1541548383574, 90.1608970121698
 , 100.170639708373, 110.176181673229, 120.182923847042, 130.189666020854, 140.199408717058, 150.212151935652, 160.221894631855, 170.228636805668, 180.23537897948, 190.242121153293
 , 200.251863849496, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.08851289, 10.0260963, 20.0065956, 30.0085526, 39.9997787, 49.999054, 60.0010071, 69.9841919, 79.9781036, 89.9880981
 , 100.000786, 109.973236, 119.956421, 129.969116, 139.960327, 149.954254, 159.956207, 169.950104, 179.935974, 189.95401
 , 199.977432, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{-0.00804662518, 9.99390984, 19.9931831, 29.9844112, 39.9783173, 49.9668655, 59.9607773, 69.9573669, 79.9459152, 89.9505463
 , 99.9364166, 109.93837, 119.932281, 129.915466, 139.890594, 149.908646, 159.983017, 169.893784, 179.874283, 189.945969
 , 199.878204, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };


#endif
//
//**********************CHANNEL_15_END************************
//




//
//**********************CHANNEL_16_START**********************
//
#if COMMUNICATION_CELL_CYCLER_CHANNEL == 16
////VOLTAGE Channel
float32 VoltageCharge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] = {0.0, };
float32 VoltageDischarge_REF[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{ 1.002, 2.002, 3.002, 4.002, 5.002 };

float32 VoltageCharge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{1.00035262 ,
2.00060797  ,
3.00078583  ,
4.00101948  ,
5.00119495  };



float32 VoltageDischarge_ADC[CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH] =
{0.999679565    ,
1.999626160 ,
2.999560037 ,
3.999633787 ,
4.999366760 };



//CURRENT
//Current Ref Cal Data
//210.0, 220.0,
float32 CurrentCharge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{-0.022013, 9.96653517377375, 19.9732773475862, 29.9860205661806, 39.992762739993, 50.0055059585874, 60.0152486547908, 70.0219908286033, 80.0377345695886, 90.044476743401
 , 100.057219961995, 110.068162867155, 120.077905563359, 130.084647737171, 140.097390955765, 150.104133129578, 160.122877392954, 170.132620089158, 180.142362785361, 190.152105481564
 , 200.164848700159, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

 float32 CurrentDischarge_REF[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.04955, 10.0709533529788, 20.0806960491822, 30.0904387453856, 40.097180919198, 50.1069236154014, 60.1136657892139, 70.1204079630264, 80.1361517040117, 90.1428938778241
 , 100.152636574028, 110.155178016493, 120.164920712696, 130.171662886509, 140.181405582712, 150.188147756524, 160.20389149751, 170.210633671322, 180.217375845135, 190.227118541338
 , 200.236861237541, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentCharge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]      =
{0.0375509225, 10.0019569, 19.9985485, 29.9978218, 40.0051422, 50.0044174, 60.0063744, 70.0110168, 80.0102844, 90.0256577
 , 100.016876, 110.016159, 120.026154, 130.022751, 140.016663, 150.037384, 160.036667, 170.052032, 180.024475, 190.021088
 , 200.036438, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };

float32 CurrentDischarge_ADC[CALIBRATION_CURRENT_MAX_ARRAY_LENGTH]   =
{0.0160932522, 10.0180492, 20.0200062, 30.0139141, 40.0105057, 50.0312424, 60.0171013, 70.0056458, 80.0183334, 90.0122452
 , 100.019562, 110.016151, 120.026161, 130.014709, 140.019348, 150.021301, 160.02861, 170.084213, 180.02449, 190.034485
 , 200.036438, 210.0, 220.0, 230.0, 240.0, 250.0, 260.0, 270.0, 280.0, 290.0, 300.0
 };



#endif
//
//**********************CHANNEL_16_END************************
//


void CALIBRATION_Init(void)
{
    float32 Temp = 0.0;
    Uint16 ui_i = 0;
#ifdef _DEBUG_PRINTF_CALL
    printf("\n");
    printf("\n");
#endif
    for(ui_i = 0; ui_i < CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH; ui_i++)
    {
        Temp = VoltageCharge_REF[ui_i];
        VoltageCharge_REF[ui_i] = (float32)(((float32)(ui_i) * (float32)(CALIBRATION_VOLATAGE_UNIT_VALUE)) - Temp);
        Temp = VoltageDischarge_REF[ui_i];
        VoltageDischarge_REF[ui_i] = (float32)(((float32)(ui_i) * (float32)(CALIBRATION_VOLATAGE_UNIT_VALUE)) - Temp);
    }

#ifdef _DEBUG_PRINTF_CALL
    for(ui_i = 0; ui_i < CALIBRATION_VOLATAGE_MAX_ARRAY_LENGTH; ui_i++)
        printf("VoltageCharge_REF = %f, VoltageDischarge_REF = %f\n",VoltageCharge_REF[ui_i], VoltageDischarge_REF[ui_i]);
#endif

    for(ui_i = 0; ui_i < CALIBRATION_CURRENT_MAX_ARRAY_LENGTH; ui_i++)
    {
        Temp = CurrentCharge_REF[ui_i];
        CurrentCharge_REF[ui_i] = (float32)(((float32)(ui_i) * (float32)(CALIBRATION_CURRENT_UNIT_VALUE)) - Temp);
        Temp = CurrentDischarge_REF[ui_i];
        CurrentDischarge_REF[ui_i] = (float32)(((float32)(ui_i) * (float32)(CALIBRATION_CURRENT_UNIT_VALUE)) - Temp);
    }
#ifdef _DEBUG_PRINTF_CALL
    for(ui_i = 0; ui_i < CALIBRATION_CURRENT_MAX_ARRAY_LENGTH; ui_i++)
        printf("CurrentCharge_REF = %f, CurrentDischarge_REF = %f\n",CurrentCharge_REF[ui_i], CurrentDischarge_REF[ui_i]);
#endif
}

//DL 2019-07-01
//float32 CALIBRATION_ConversionREF(float REF_Data, float *CAL_Data, float InitialValue, float Unit, Uint16 ArrayLength)
//{
//    Uint32 ArrayAddressValue = 0.0;
//
//    float RefRateValue = 0.0;
//    float RefDeltaValue = 0.0;
//    float ErrorValue = 0.0;
//    float ErrorValuePlus = 0.0;
//    float ErrorResult = 0.0;
//    float Result = 0.0;
//
//    if(REF_Data < InitialValue && REF_Data != 0.0)
//    {
//        Result = (float32)(REF_Data);
//        return (Result);
//    }
//
//    ArrayAddressValue   = (Uint32)((Uint32)((REF_Data - InitialValue) * 10000.0) / (Uint32)(10000.0 * Unit));
//    ErrorValue          = ((((float)(ArrayAddressValue) * Unit) + InitialValue)     - CAL_Data[ArrayAddressValue]);
//
//    if(ArrayAddressValue < ArrayLength)
//    {
//        ErrorValuePlus  = ((((float)(ArrayAddressValue + 1) * Unit) + InitialValue) - CAL_Data[ArrayAddressValue + 1]);
//        RefDeltaValue   = (ErrorValuePlus - ErrorValue);
//        RefRateValue    = (((REF_Data - InitialValue) - ((float)(ArrayAddressValue) * Unit)) / Unit); //보정값 범위내 설정값 비율
////        RefRateValue    = ((REF_Data - InitialValue) / Unit); //보정값 범위내 설정값 비율
//        ErrorResult     = (RefDeltaValue * RefRateValue);
//    }
//    else
//    {
//        ErrorResult = 0.0;
//    }
//    Result = (REF_Data + ErrorValue) + ErrorResult;
//
//    if(CAL_Data[ArrayAddressValue] == 0.0) Result = (float32)(REF_Data);
//    return (Result);
//}
//End DL 2019-07-01

float32 CALIBRATION_ConversionADC(float ADC_Data, float *Measure_Data, float *CAL_Data, float InitialValue, float Unit, Uint16 ArrayLength)
{
    Uint16 ui_i = 0;
    Uint16 ArrayAddressValue = 0.0;
    float AdcRateValue = 0.0;
    float AdcDeltaValue = 0.0;
    float MeasureDeltaValue = 0.0;
    float ErrorValueResult = 0.0;
    float Result = 0.0;

    //ADC_Data 양수
    //CAL_Data 양수
    //InitialValue 양수
    for(ui_i = ArrayAddressValue; ui_i < ArrayLength; ui_i++)
    {
        if(CAL_Data[ui_i] >= ADC_Data)break;
        else ArrayAddressValue++;
    }

    if(ADC_Data < InitialValue)
    {
        Result = (float32)(ADC_Data);
        return (Result);
    }
    else if(ArrayAddressValue < ArrayLength)
    {
        AdcDeltaValue       = (CAL_Data[ArrayAddressValue + 1] - CAL_Data[ArrayAddressValue]) - Unit;
        MeasureDeltaValue   = (Measure_Data[ArrayAddressValue + 1] - Measure_Data[ArrayAddressValue]);
        AdcRateValue        = (ADC_Data - Measure_Data[ArrayAddressValue]) / MeasureDeltaValue ; //보정값 범위내 설정값 비율

        ErrorValueResult    = (AdcDeltaValue * AdcRateValue);
    }
    else
    {
        ErrorValueResult    = 0.0;
    }

    //Result = ((float)(ArrayAddressValue) * Unit) + ((Measure_Data[ArrayAddressValue] - ADC_Data) + InitialValue) + ErrorValueResult;
    Result = CAL_Data[ArrayAddressValue] + ErrorValueResult;

    if(CAL_Data[ArrayAddressValue] == 0.0) Result = (float32)(ADC_Data);

    return (Result);
}

float32 CALIBRATION_ConversionCurrentADC(float32 ADC_Data, float32 *Measure_Data, float32 *CAL_Data, float32 InitialValue, float32 Unit, Uint16 ArrayLength)
{
    Uint16 ArrayAddressValue = 0.0;
    Uint16 ui_i = 0;
    float AdcRateValue = 0.0;
    float AdcDeltaValue = 0.0;
    float MeasureDeltaValue = 0.0;
    float ErrorValueResult = 0.0;
    float Result = 0.0;
    Uint16 Flag = CLEAR;
    //ADC_Data 양수
    //CAL_Data 양수
    //InitialValue 양수
    if(ADC_Data >= InitialValue)
    {
//        ArrayAddressValue = ((Uint16)(((ADC_Data - InitialValue) / Unit) * 1000)) / (Uint16)(1000);
        for(ui_i = 0; ui_i < ArrayLength; ui_i++)
        {
            if(Measure_Data[ui_i] >= ADC_Data)
            {
                Flag = SET;
                ArrayAddressValue = ui_i;
                break;
            }
//            else ArrayAddressValue++;
        }
        if(Flag == CLEAR)
        {
            ArrayAddressValue = ArrayLength - 1;
        }
    }
    else
    {
        Result = (float32)(ADC_Data);
        return (Result);
    }

    if(ArrayAddressValue < ArrayLength - 1)
    {

        AdcDeltaValue       = (((((ArrayAddressValue + 1) * Unit) + InitialValue) - (CAL_Data[ArrayAddressValue + 1])) -
                                (((ArrayAddressValue * Unit)      + InitialValue) -  CAL_Data[ArrayAddressValue]));

        MeasureDeltaValue   = (Unit);
        AdcRateValue        = (ADC_Data - Measure_Data[ArrayAddressValue]) / MeasureDeltaValue ; //보정값 범위내 설정값 비율

        ErrorValueResult    = (CAL_Data[ArrayAddressValue] - Measure_Data[ArrayAddressValue]) + (AdcDeltaValue * ABS_F(AdcRateValue));
        Result = ADC_Data + ErrorValueResult;
    }
    else //if(ArrayAddressValue < ArrayLength)
    {
        ErrorValueResult    = (CAL_Data[ArrayLength - 1] - Measure_Data[ArrayLength - 1]);
        Result = ADC_Data + ErrorValueResult;
    }
//    else
//    {
//        ErrorValueResult    = (CAL_Data[ArrayAddressValue - 1] - Measure_Data[ArrayAddressValue - 1]);
//        Result = ADC_Data + ErrorValueResult;
//    }

    if(CAL_Data[ArrayAddressValue] == 0.0) Result = (float32)(ADC_Data);

    return (Result);
//    if(ADC_Data >= InitialValue)ArrayAddressValue = ((Uint16)(((ADC_Data - InitialValue) / Unit) * 1000)) / (Uint16)(1000);
//    else
//    {
//        Result = (float32)(ADC_Data);
//        return (Result);
//    }
//
//    if(ArrayAddressValue < ArrayLength - 1)
//    {
//
//        AdcDeltaValue       = ((CAL_Data[ArrayAddressValue + 1] - Measure_Data[ArrayAddressValue + 1]) -
//                               (CAL_Data[ArrayAddressValue])    - Measure_Data[ArrayAddressValue]);
//
//        MeasureDeltaValue   = (Unit);
//        AdcRateValue        = (ADC_Data - Measure_Data[ArrayAddressValue]) / MeasureDeltaValue ; //보정값 범위내 설정값 비율
//
//        ErrorValueResult    = (CAL_Data[ArrayAddressValue] - Measure_Data[ArrayAddressValue]) + (AdcDeltaValue * ABS_F(AdcRateValue));
//        Result = ADC_Data + ErrorValueResult;
//    }
//    else if(ArrayAddressValue < ArrayLength)
//    {
//        ErrorValueResult    = (CAL_Data[ArrayAddressValue] - Measure_Data[ArrayAddressValue]);
//        Result = ADC_Data + ErrorValueResult;
//    }
//    else
//    {
//        ErrorValueResult    = (CAL_Data[ArrayAddressValue - 1] - Measure_Data[ArrayAddressValue - 1]);
//        Result = ADC_Data + ErrorValueResult;
//    }
//
//    if(CAL_Data[ArrayAddressValue] == 0.0) Result = (float32)(ADC_Data);
//
//    return (Result);
}

//float32 CALIBRATION_ConversionCurrentADC(float32 ADC_Data, float32 *Measure_Data, float32 *CAL_Data, float32 InitialValue, float32 Unit, Uint16 ArrayLength)
//{
//    Uint16 ui_i = 0;
//    Uint16 ArrayAddressValue = 0.0;
//    float AdcRateValue = 0.0;
//    float AdcDeltaValue = 0.0;
//    float MeasureDeltaValue = 0.0;
//    float ErrorValueResult = 0.0;
//    float Result = 0.0;
//
//    //ADC_Data 양수
//    //CAL_Data 양수
//    //InitialValue 양수
//    for(ui_i = ArrayAddressValue; ui_i < ArrayLength; ui_i++)
//    {
//        if(CAL_Data[ui_i] >= ADC_Data)break;
//        else ArrayAddressValue++;
//    }
//
//    if(ADC_Data < InitialValue)
//    {
//        Result = (float32)(ADC_Data);
//        return (Result);
//    }
//    else if(ArrayAddressValue < ArrayLength)
//    {
//        AdcDeltaValue       = (CAL_Data[ArrayAddressValue + 1] - CAL_Data[ArrayAddressValue]) - Unit;
//        MeasureDeltaValue   = (Measure_Data[ArrayAddressValue + 1] - Measure_Data[ArrayAddressValue]);
//        AdcRateValue        = (ADC_Data - Measure_Data[ArrayAddressValue]) / MeasureDeltaValue ; //보정값 범위내 설정값 비율
//
//        ErrorValueResult    = (AdcDeltaValue * AdcRateValue);
//    }
//    else
//    {
//        ErrorValueResult    = 0.0;
//    }
//
//    //Result = ((float)(ArrayAddressValue) * Unit) + ((Measure_Data[ArrayAddressValue] - ADC_Data) + InitialValue) + ErrorValueResult;
//    Result = CAL_Data[ArrayAddressValue] + ErrorValueResult;
//
//    if(CAL_Data[ArrayAddressValue] == 0.0) Result = (float32)(ADC_Data);
//
//    return (Result);
//}

//DL 2019-07-01
//float32 CALIBRATION_ConversionVoltageADC(float32 ADC_Data, float32 *CAL_Data, float32 InitialValue, float32 Unit, Uint16 ArrayLength)
//{
//    Uint16 ArrayAddressValue = 0.0;
//    Uint16 ui_i = 0;
//    float AdcRateValue = 0.0;
//    float AdcDeltaValue = 0.0;
//    float MeasureDeltaValue = 0.0;
//    float ErrorValueResult = 0.0;
//    float Result = 0.0;
//    Uint16 Flag = CLEAR;
//    //ADC_Data 양수
//    //CAL_Data 양수
//    //InitialValue 양수
//    if(ADC_Data >= InitialValue)
//    {
////        ArrayAddressValue = ((Uint16)(((ADC_Data - InitialValue) / Unit) * 1000)) / (Uint16)(1000);
//        for(ui_i = 0; ui_i < ArrayLength; ui_i++)
//        {
//            if(CAL_Data[ui_i] >= ADC_Data)
//            {
//                Flag = SET;
//                ArrayAddressValue = ui_i;
//                break;
//            }
////            else ArrayAddressValue++;
//        }
//        if(Flag == CLEAR)
//        {
//            ArrayAddressValue = ArrayLength - 1;
//        }
//    }
//    else
//    {
//        Result = (float32)(ADC_Data);
//        return (Result);
//    }
//
//    if(ArrayAddressValue < ArrayLength - 1)
//    {
//        AdcDeltaValue       = (((((ArrayAddressValue + 1) * Unit) + InitialValue) - (CAL_Data[ArrayAddressValue + 1])) -
//                                (((ArrayAddressValue * Unit)      + InitialValue) -  CAL_Data[ArrayAddressValue]));
//
//        MeasureDeltaValue   = (Unit);
//        AdcRateValue        = (ADC_Data - CAL_Data[ArrayAddressValue]) / MeasureDeltaValue ; //보정값 범위내 설정값 비율
//
//        ErrorValueResult    = (((ArrayAddressValue * Unit) + InitialValue) - CAL_Data[ArrayAddressValue]) + (AdcDeltaValue * ABS_F(AdcRateValue));
//        Result = ADC_Data + ErrorValueResult;
//    }
//    else
//    {
//        ErrorValueResult    = (((ArrayAddressValue * Unit) + InitialValue) - CAL_Data[ArrayLength - 1]);
//        Result = ADC_Data + ErrorValueResult;
//    }
//
//    if(CAL_Data[ArrayAddressValue] == 0.0) Result = (float32)(ADC_Data);
//
//    return (Result);
//}

float32 CALIBRATION_ConversionVoltageADC(float32 ADC_Data, float32 *CAL_Data, float32 InitialValue, float32 Unit, Uint16 ArrayLength)
{
    Uint32 ArrayAddressValue = 0.0;
    Uint16 ui_i = 0;

    float RefRateValue = 0.0;
    float RefDeltaValue = 0.0;
    float ErrorValue = 0.0;
    float ErrorValuePlus = 0.0;
    float ErrorResult = 0.0;
    float Result = 0.0;

    if(ADC_Data > CAL_Data[0] && ADC_Data <= CAL_Data[ArrayLength - 1])
    {
        for(ui_i = 0; ui_i < ArrayLength; ui_i++)
        {
            if(CAL_Data[ui_i] >= ADC_Data)
            {
                ArrayAddressValue = ui_i - 1;
                break;
            }
        }
    }
    else
    {
        return (ADC_Data);
    }

    ErrorValue          = ((((float)(ArrayAddressValue) * Unit) + InitialValue)     - CAL_Data[ArrayAddressValue]);

    if(ArrayAddressValue < ArrayLength - 1) //DL 2019-07-01 if(ArrayAddressValue < ArrayLength)
    {
        ErrorValuePlus  = ((((float)(ArrayAddressValue + 1) * Unit) + InitialValue) - CAL_Data[ArrayAddressValue + 1]);
        RefDeltaValue   = (ErrorValuePlus - ErrorValue);
        RefRateValue    = (((ADC_Data - InitialValue) - ((float)(ArrayAddressValue) * Unit)) / Unit);
        ErrorResult     = (RefDeltaValue * RefRateValue);
    }
    else
    {
        ErrorResult = 0.0;
    }
    Result = (ADC_Data + ErrorValue) + ErrorResult;

    if(CAL_Data[ArrayAddressValue] == 0.0) Result = (float32)(ADC_Data);
    return (Result);
}

float32 CALIBRATION_ConversionREF(float REF_Data, float *CAL_Data, float InitialValue, float Unit, Uint16 ArrayLength)
{
    Uint32 ArrayAddressValue = 0.0;
    Uint16 ui_i = 0;

    float RefRateValue = 0.0;
    float RefDeltaValue = 0.0;
    float ErrorValue = 0.0;
    float ErrorValuePlus = 0.0;
    float ErrorResult = 0.0;
    float Result = 0.0;

    if(REF_Data > CAL_Data[0] && REF_Data <= CAL_Data[ArrayLength - 1])
    {
        for(ui_i = 0; ui_i < ArrayLength; ui_i++)
        {
            if(CAL_Data[ui_i] >= REF_Data)
            {
                ArrayAddressValue = ui_i - 1;
                break;
            }
        }
    }
    else
    {
        return (REF_Data);
    }

    ErrorValue          = ((((float)(ArrayAddressValue) * Unit) + InitialValue)     - CAL_Data[ArrayAddressValue]);

    if(ArrayAddressValue < ArrayLength - 1) //DL 2019-07-01 if(ArrayAddressValue < ArrayLength)
    {
        ErrorValuePlus  = ((((float)(ArrayAddressValue + 1) * Unit) + InitialValue) - CAL_Data[ArrayAddressValue + 1]);
        RefDeltaValue   = (ErrorValuePlus - ErrorValue);
        RefRateValue    = (((REF_Data - InitialValue) - ((float)(ArrayAddressValue) * Unit)) / Unit); //보정값 범위내 설정값 비율
//        RefRateValue    = ((REF_Data - InitialValue) / Unit); //보정값 범위내 설정값 비율
        ErrorResult     = (RefDeltaValue * RefRateValue);
    }
    else
    {
        ErrorResult = 0.0;
    }
    Result = (REF_Data + ErrorValue) + ErrorResult;

    if(CAL_Data[ArrayAddressValue] == 0.0) Result = (float32)(REF_Data);
    return (Result);
}

//End DL 2019-07-01
//
// End of file
//
